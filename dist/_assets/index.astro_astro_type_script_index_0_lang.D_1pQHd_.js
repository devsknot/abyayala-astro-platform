class q{constructor(e){this.inputId=e,this.input=document.getElementById(e),this.calendarContainer=document.getElementById(`${e}-calendar`),this.toggleButton=this.input.parentElement.querySelector(".date-picker-toggle"),this.monthYearDisplay=this.calendarContainer.querySelector(".date-picker-month-year"),this.daysContainer=this.calendarContainer.querySelector(".date-picker-days"),this.prevButton=this.calendarContainer.querySelector(".date-picker-prev"),this.nextButton=this.calendarContainer.querySelector(".date-picker-next"),this.clearButton=this.calendarContainer.querySelector(".date-picker-clear"),this.todayButton=this.calendarContainer.querySelector(".date-picker-today"),this.closeButton=this.calendarContainer.querySelector(".date-picker-close"),this.currentDate=new Date,this.selectedDate=null,this.viewDate=new Date,this.monthNames=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],this.init()}init(){this.input.addEventListener("click",()=>this.toggleCalendar()),this.toggleButton.addEventListener("click",()=>this.toggleCalendar()),this.prevButton.addEventListener("click",()=>this.prevMonth()),this.nextButton.addEventListener("click",()=>this.nextMonth()),this.clearButton.addEventListener("click",()=>this.clearDate()),this.todayButton.addEventListener("click",()=>this.selectToday()),this.closeButton.addEventListener("click",()=>this.hideCalendar()),document.addEventListener("click",e=>{!this.calendarContainer.contains(e.target)&&e.target!==this.input&&e.target!==this.toggleButton&&!this.toggleButton.contains(e.target)&&this.hideCalendar()}),this.renderCalendar()}toggleCalendar(){this.calendarContainer.classList.contains("active")?this.hideCalendar():this.showCalendar()}showCalendar(){this.calendarContainer.classList.add("active"),this.renderCalendar(),this.selectedDate&&(this.viewDate=new Date(this.selectedDate),this.renderCalendar())}hideCalendar(){this.calendarContainer.classList.remove("active")}renderCalendar(){this.monthYearDisplay.textContent=`${this.monthNames[this.viewDate.getMonth()]} ${this.viewDate.getFullYear()}`,this.daysContainer.innerHTML="";const e=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),1),h=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()+1,0),c=e.getDay(),g=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),0).getDate();for(let i=c-1;i>=0;i--){const a=document.createElement("div");a.classList.add("date-picker-day","other-month"),a.textContent=g-i,this.daysContainer.appendChild(a)}const u=new Date;for(let i=1;i<=h.getDate();i++){const a=document.createElement("div");a.classList.add("date-picker-day"),a.textContent=i,this.viewDate.getFullYear()===u.getFullYear()&&this.viewDate.getMonth()===u.getMonth()&&i===u.getDate()&&a.classList.add("today"),this.selectedDate&&this.viewDate.getFullYear()===this.selectedDate.getFullYear()&&this.viewDate.getMonth()===this.selectedDate.getMonth()&&i===this.selectedDate.getDate()&&a.classList.add("selected"),a.addEventListener("click",()=>{this.selectDate(new Date(this.viewDate.getFullYear(),this.viewDate.getMonth(),i))}),this.daysContainer.appendChild(a)}const m=42-(c+h.getDate());for(let i=1;i<=m;i++){const a=document.createElement("div");a.classList.add("date-picker-day","other-month"),a.textContent=i,this.daysContainer.appendChild(a)}}prevMonth(){this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-1,1),this.renderCalendar()}nextMonth(){this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()+1,1),this.renderCalendar()}selectDate(e){this.selectedDate=e;const h=e.getDate().toString().padStart(2,"0"),c=(e.getMonth()+1).toString().padStart(2,"0"),g=e.getFullYear();this.input.value=`${h}/${c}/${g}`;const u=new Event("change",{bubbles:!0});this.input.dispatchEvent(u),this.renderCalendar(),this.hideCalendar()}clearDate(){this.selectedDate=null,this.input.value="";const e=new Event("change",{bubbles:!0});this.input.dispatchEvent(e),this.renderCalendar()}selectToday(){const e=new Date;this.viewDate=new Date(e),this.selectDate(e)}getSelectedDateISO(){return this.selectedDate?this.selectedDate.toISOString().split("T")[0]:null}getSelectedDate(){return this.selectedDate}}document.addEventListener("DOMContentLoaded",()=>{const y=new q("date-from"),e=new q("date-to"),h=document.getElementById("search-input"),c=document.getElementById("category-select"),g=document.getElementById("clear-filters"),u=document.querySelectorAll(".news-card"),m=document.querySelector(".no-results"),i=document.getElementById("active-filters"),a=9;let s=1,v=Array.from(u);const p=document.querySelector(".pagination-prev"),f=document.querySelector(".pagination-next"),S=document.querySelector(".current-page"),L=document.querySelector(".total-pages");function d(){const t=h.value.toLowerCase().trim(),o=c.value,r=y.getSelectedDate(),n=e.getSelectedDate();I(t,o,r,n),v=Array.from(u).filter(l=>{const Y=l.querySelector(".news-title")?.textContent?.toLowerCase()||"",$=l.querySelector(".news-excerpt")?.textContent?.toLowerCase()||"",F=l.dataset.category?.toLowerCase()||"",b=l.dataset.date||"",D=b?new Date(b):null,P=!t||Y.includes(t)||$.includes(t)||F.includes(t),A=o===""||F===o.toLowerCase();let C=!0;return D&&(r&&n?C=D>=r&&D<=n:r?C=D>=r:n&&(C=D<=n)),P&&A&&C}),E()}function E(){u.forEach(n=>{n.style.display="none"});const t=Math.ceil(v.length/a);s>t&&(s=t||1),S&&(S.textContent=s.toString()),L&&(L.textContent=t.toString()),p&&(p.disabled=s<=1),f&&(f.disabled=s>=t);const o=(s-1)*a,r=Math.min(o+a,v.length);for(let n=o;n<r;n++)v[n].style.display="";m&&(m.style.display=v.length===0?"block":"none")}function I(t,o,r,n){if(i){if(i.innerHTML="",t&&w("Búsqueda",t,()=>{h.value="",d()}),o&&o!==""){const l=c.options[c.selectedIndex].text;w("Categoría",l,()=>{c.value="",d()})}if(r){const l=k(r);w("Desde",l,()=>{y.clearDate(),d()})}if(n){const l=k(n);w("Hasta",l,()=>{e.clearDate(),d()})}}}function w(t,o,r){const n=document.createElement("div");n.className="active-filter",n.innerHTML=`
        <span>${t}: ${o}</span>
        <button type="button" aria-label="Eliminar filtro">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      `;const l=n.querySelector("button");l&&l.addEventListener("click",r),i?.appendChild(n)}function k(t){const o=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return`${o}/${r}/${n}`}function x(){h.value="",c.value="",y.clearDate(),e.clearDate(),s=1,d()}h&&h.addEventListener("input",()=>{s=1,d()}),c&&c.addEventListener("change",()=>{s=1,d()}),g&&g.addEventListener("click",x),document.querySelectorAll(".clear-filters-btn").forEach(t=>{t.addEventListener("click",x)});const B=document.getElementById("date-from");B&&B.addEventListener("change",()=>{s=1,d()});const M=document.getElementById("date-to");M&&M.addEventListener("change",()=>{s=1,d()}),document.querySelector(".date-from")?.addEventListener("dateSelected",()=>{s=1,d()}),document.querySelector(".date-to")?.addEventListener("dateSelected",()=>{s=1,d()}),p&&p.addEventListener("click",()=>{s>1&&(s--,E())}),f&&f.addEventListener("click",()=>{const t=Math.ceil(v.length/a);s<t&&(s++,E())}),d()});
